This chapter will introduce and develop the \rrtfunnel{} algorithm, by two
means: First develop robust motion primitives through the \ac{SOS} programming
framework based on the work by \cite{majumdarFunnelLibrariesRealtime2017},
and second, deploy these funnels as robust motion primitives in a discrete
\ac{RRT} robust motion planner based on \cite{Lav06}. Using robust motion
primitives has several advantages. Firstly, they handle uncertainty, and thus,
as long as the uncertainties in the system are akin to the assumptions on the
incoming uncertainty parameters, the dynamical system will not leave the funnel,
and hence if the funnel is not in collision, neither will the system be.
Secondly, as the motion primitives are robust, there is no need for more
conservative maneuvers and heuristics, such as maximizing the distance to an
obstacle, which many motion planners do in order to handle uncertainty. Since
the primitives are robust, the system might as well choose a primitive that is
close to an obstacle, as one that is far away, since the funnel is guaranteed to
be collision-free in both cases. This means that a robust motion algorithm can
perform more aggressive maneuvers than one that is inherently conservative about
its environment and maneuvers~\cite{singhRobustOnlineMotion2017}.

The outline of the chapter is as follows: First it introduces the generation of
the trajectories in \cref{subsec:generating-the-trajectories}, then moves on to
making the model in \cref{eq:model-dynamics} independent of the system input
using a \ac{TV-LQR}-controller. In \cref{subsec:generating-funnels} the funnels
are generated for the basic formulation, which takes no uncertainty into
account. Then later in \cref{subsec:xy-cost-function}, the cost function for the
funnel generation is modified, so that it seeks to minimize the size of the
funnel projected down in the xy-plane. Following in
\cref{subsec:searching-for-a-controller}, the \ac{SOS} formulation from the
funnel generation algorithm is modified so that it, in addition to minimizing
the size of the funnel in the xy-plane, it also searches for a controller which
seeks to minimize the cost function. Following in \cref{sec:adding-uncertainty}
is the additional formulations needed to make the funnels robust to
uncertainties, then in \cref{subsec:shifting-funnels,sec:composable-funnels},
the composition and translation of the generated motion primitives are explored
in order to employ them in the \ac{RRT} planning algorithm developed in
\cref{sec:RRT}, which further explores the sampling and distance metric employed
in the on-line planning stage of the algorithm.
